'use strict';var performance,define,exports,module;void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});
var TWEEN=TWEEN||function(){var a=[];return{REVISION:"14",getAll:function(){return a},removeAll:function(){a=[]},add:function(b){a.push(b)},remove:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1)},update:function(b){if(0===a.length)return!1;var c=0;for(b=void 0!==b?b:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();c<a.length;)a[c].update(b)?c++:a.splice(c,1);return!0}}}();
TWEEN.Tween=function(a){var b={},c={},d={},e=1E3,f=0,h=!1,k=!1,s=0,q=null,x=TWEEN.Easing.Linear.None,y=TWEEN.Interpolation.Linear,r=[],t=null,u=!1,v=null,w=null,m=null,n;for(n in a)b[n]=parseFloat(a[n],10);this.to=function(a,b){return void 0!==b&&(e=b),c=a,this};this.start=function(e){TWEEN.add(this);k=!0;u=!1;q=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();q+=s;for(var g in c){if(c[g]instanceof Array){if(0===
c[g].length)continue;c[g]=[a[g]].concat(c[g])}b[g]=a[g];!1==b[g]instanceof Array&&(b[g]*=1);d[g]=b[g]||0}return this};this.stop=function(){return k?(TWEEN.remove(this),k=!1,null!==m&&m.call(a),this.stopChainedTweens(),this):this};this.stopChainedTweens=function(){for(var a=0,b=r.length;b>a;a++)r[a].stop()};this.delay=function(a){return s=a,this};this.repeat=function(a){return f=a,this};this.yoyo=function(a){return h=a,this};this.easing=function(a){return x=a,this};this.interpolation=function(a){return y=
a,this};this.chain=function(){return r=arguments,this};this.onStart=function(a){return t=a,this};this.onUpdate=function(a){return v=a,this};this.onComplete=function(a){return w=a,this};this.onStop=function(a){return m=a,this};this.update=function(k){var g;if(q>k)return!0;!1===u&&(null!==t&&t.call(a),u=!0);var l=(k-q)/e,l=1<l?1:l,m=x(l);for(g in c){var n=b[g]||0,p=c[g];p instanceof Array?a[g]=y(p,m):("string"==typeof p&&(p=n+parseFloat(p,10)),"number"==typeof p&&(a[g]=n+(p-n)*m))}if(null!==v&&v.call(a,
m),1==l){if(0<f){isFinite(f)&&f--;for(g in d){if("string"==typeof c[g]&&(d[g]+=parseFloat(c[g],10)),h)l=d[g],d[g]=c[g],c[g]=l;b[g]=d[g]}return q=k+s,!0}null!==w&&w.call(a);g=0;for(l=r.length;l>g;g++)r[g].start(k);return!1}return!0}};
TWEEN.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?0.5*a*a:-0.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a:0.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a:-0.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*
a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a*a:0.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return 0.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?0.5*Math.pow(1024,a-1):0.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-
Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){var b,c=0.1;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI),-(c*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/0.4)))},Out:function(a){var b,c=0.1;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI),c*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/0.4)+1)},InOut:function(a){var b,
c=0.1;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI),1>(a*=2)?-0.5*c*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/0.4):c*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/0.4)*0.5+1)}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*(3.5949095*a-2.5949095):0.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-TWEEN.Easing.Bounce.Out(1-a)},Out:function(a){return 1/
2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+0.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},InOut:function(a){return 0.5>a?0.5*TWEEN.Easing.Bounce.In(2*a):0.5*TWEEN.Easing.Bounce.Out(2*a-1)+0.5}}};
TWEEN.Interpolation={Linear:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d),f=TWEEN.Interpolation.Utils.Linear;return 0>b?f(a[0],a[1],d):1<b?f(a[c],a[c-1],c-d):f(a[e],a[e+1>c?c:e+1],d-e)},Bezier:function(a,b){var c,d=0,e=a.length-1,f=Math.pow,h=TWEEN.Interpolation.Utils.Bernstein;for(c=0;e>=c;c++)d+=f(1-b,e-c)*f(b,c)*a[c]*h(e,c);return d},CatmullRom:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d),f=TWEEN.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(e=Math.floor(d=c*(1+b))),f(a[(e-
1+c)%c],a[e],a[(e+1)%c],a[(e+2)%c],d-e)):0>b?a[0]-(f(a[0],a[0],a[1],a[1],-d)-a[0]):1<b?a[c]-(f(a[c],a[c],a[c-1],a[c-1],d-c)-a[c]):f(a[e?e-1:0],a[e],a[e+1>c?c:e+1],a[e+2>c?c:e+2],d-e)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=TWEEN.Interpolation.Utils.Factorial;return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c,d=1;if(a[b])return a[b];for(c=b;1<c;c--)d*=c;return a[b]=d}}(),CatmullRom:function(a,b,c,d,e){a=0.5*(c-a);d=0.5*(d-b);var f=
e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b}}};"undefined"!=typeof module&&module.exports&&(module.exports=TWEEN);var UIL,loop,rootUpdate,NEO=NEO||function(){return{main:null,REVISION:"0.2",DEF:!1,DID:0,events:"onkeyup onkeydown onclick onchange onmouseover onmouseout onmousemove onmousedown onmouseup onmousewheel".split(" "),WIDTH:300,BW:190,AW:100,svgns:"http://www.w3.org/2000/svg",sizer:function(a){this.WIDTH=a.toFixed(0);a=this.WIDTH/3;this.BW=2*a-10;this.AW=a;this.main&&this.main.changeWidth()},classDefine:function(){NEO.COLOR="NO";NEO.txt1='font-family:"Open Sans", sans-serif; font-size:11px; color:#cccccc; outline:0; padding:0px 10px; left:0; top:1px; height:17px; width:100px; overflow:hidden;';
NEO.CC("NEO","position:absolute; pointer-events:none; box-sizing:border-box; -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select:none; margin:0; padding:0; border:none; ");NEO.CC("NEO.content","bottom:0; left:0; width:100px; overflow:hidden; background:none; pointer-events:auto; transition:height, 0.1s ease-out;");NEO.CC("NEO.topcontent","bottom:0; left:0; width:100px; background:none;");NEO.CC("NEO.topmenu","width:100%; height:24px; background:none; ");
NEO.CC("NEO.timeBar","width:100px; height:20px; top:20px; background:none; pointer-events:auto; cursor:e-resize;");NEO.CC("NEO.timescale","width:100px; height:20px; background:none; bottom:0; pointer-events:auto; cursor:e-resize;");NEO.CC("NEO.inner","width:100%; top:40px; height:auto; overflow:hidden; background:none;");NEO.CC("NEO.base","position:relative; transition:height, 0.1s ease-out; height:80px; overflow:hidden;");NEO.CC("NEO.track","position:absolute; left:0; top:20px; width:100px; height:60px; overflow:hidden; pointer-events:auto; cursor:pointer; background:none; ");
NEO.CC("NEO.trackTop","position:absolute; left:0; top:20px; width:100%; height:60px; overflow:hidden; pointer-events:none; background:none; ");NEO.CC("NEO.text",NEO.txt1);NEO.DEF=!0},bgcolor:function(a,b){var c=48,d=48,e=48;b=b||0.66;if(a)switch(a){case "r":case "R":case "S":c=160;e=68;break;case "g":case "G":case "E":d=120;e=68;break;case "b":case "B":case "T":e=120;d=68;break;case "no":case "NO":b=0}c="rgba("+c+","+d+","+e+","+b+")";0==b&&(c="none");return c},setSVG:function(a,b,c,d){a.childNodes[d||
0].setAttributeNS(null,b,c)},setDOM:function(a,b,c){a.style[b]=c+"px"},clearDOM:function(a){for(;a.children.length;)a.removeChild(a.lastChild)},DOM:function(a,b,c,d,e,f){b=b||"div";if("rect"==b||"path"==b||"polygon"==b||"text"==b||"pattern"==b||"defs"==b||"g"==b||"line"==b||"foreignObject"==b||"linearGradient"==b||"stop"==b||"animate"==b||"radialGradient"==b){void 0==e&&(e=document.createElementNS(this.svgns,"svg"));b=document.createElementNS(this.svgns,b);for(var h in d)"txt"==h?b.textContent=d[h]:
b.setAttributeNS(null,h,d[h]);void 0==f?e.appendChild(b):e.childNodes[f||0].appendChild(b);a&&e.setAttribute("class",a)}else void 0==e&&(e=document.createElement(b)),a&&(e.className=a);c&&(e.style.cssText=c);return void 0==f?e:e.childNodes[f||0]},CC:function(a,b,c){var d=".";c&&(d="");"*"==a&&(d="");c=document.createElement("style");c.type="text/css";document.getElementsByTagName("head")[0].appendChild(c);(c.sheet||{}).insertRule?c.sheet.insertRule(d+a+"{"+b+"}",0):(c.styleSheet||c.sheet).addRule(d+
a,b)}}}();
NEO.Timeline=function(a,b){this.data={};this.time=this.frame=0;this.height=60;this.width=100;this.maxTop=145;this.decal=b||0;this.frameSize=10;this.currentLeftFrame=0;this.viewFrame=Math.round(this.width/this.frameSize);this.fps=60;this.timerStep=1E3/this.fps;this.delta=this.now=0;this.then=Date.now();this.maxFrame=750;this.maxSize=this.frameSize*this.maxFrame;this.currentPosition=this.currentLeftFrame*this.frameSize;this.ratio=this.maxFrame/this.width;this.viewFrame=this.width/this.frameSize;this.posX=
0;this.inPlay=this.scrolldown=this.timerdown=!1;this.neo=[];this.f=[];this.content=NEO.DOM("NEO content","div",a);document.body.appendChild(this.content);this.topcontent=NEO.DOM("NEO topcontent","div",a);document.body.appendChild(this.topcontent);this.top=parseFloat(this.content.style.top.substring(0,this.content.style.top.length-2));this.topmenu=NEO.DOM("NEO topmenu");this.topmenu.appendChild(this.liner(1));var c=function(a){this.scaletime(a)}.bind(this),d=function(a){this.setFps(a)}.bind(this),
e=function(a){this.add(a);this.addList.text("ADD")}.bind(this),f=function(a){this.play()}.bind(this),h=function(a){this.goTo(0,!0)}.bind(this),k=function(a){this.goTo(this.maxFrame,!0)}.bind(this);this.sizer=new UIL.Slide({target:this.topmenu,callback:c,name:"scale",min:0.1,max:4,value:0.8,step:0.1,color:"no",size:150,pos:{left:"auto",right:"0",top:"2px"}});this.butFps=new UIL.Number({target:this.topmenu,callback:d,name:"fps",min:12,max:60,value:60,step:1,color:"no",size:82,pos:{left:"auto",right:"130px",
top:"2px"}});this.title=new UIL.Title({target:this.topmenu,name:"0:00:00",color:"no",size:120,height:20,pos:{top:"2px"}});this.addList=new UIL.List({target:this.topmenu,callback:e,name:" ",color:"no",list:"bang flag curve lfo color switch audio video".split(" "),size:80,pos:{left:"100px",top:"2px"},simple:!0});this.addList.text("ADD");this.playButton=new UIL.Button({target:this.topmenu,callback:f,name:"X",color:"no",size:40,pos:{left:"210px",top:"2px"},simple:!0});this.startButton=new UIL.Button({target:this.topmenu,
callback:h,name:"X",color:"no",size:20,pos:{left:"190px",top:"2px"},simple:!0});this.endButton=new UIL.Button({target:this.topmenu,callback:k,name:"X",color:"no",size:20,pos:{left:"250px",top:"2px"},simple:!0});this.playIcon="<svg xmlns='http://www.w3.org/2000/svg' width='18px' height='17px'><path fill='#CCC' d='M 14 8 L 5 3 4 4 4 13 5 14 14 9 14 8 Z'/></svg>";this.pauseIcon="<svg xmlns='http://www.w3.org/2000/svg' width='18px' height='17px'><path fill='#CCC' d='M 14 4 L 13 3 11 3 10 4 10 13 11 14 13 14 14 13 14 4 M 8 4 L 7 3 5 3 4 4 4 13 5 14 7 14 8 13 8 4 Z'/></svg>";
this.startIcon="<svg xmlns='http://www.w3.org/2000/svg' width='18px' height='17px'><path fill='#CCC' d='M 11 12 L 11 10 14 10 14 7 11 7 11 5 8 8 8 9 11 12 M 7 12 L 6 12 6 5 7 5 7 3 4 3 4 14 7 14 7 12 Z'/></svg>";this.endIcon="<svg xmlns='http://www.w3.org/2000/svg' width='18px' height='17px'><path fill='#CCC' d='M 10 8 L 7 5 7 7 4 7 4 10 7 10 7 12 10 9 10 8 M 14 3 L 11 3 11 5 12 5 12 12 11 12 11 14 14 14 14 3 Z'/></svg>";this.playButton.icon(this.playIcon);this.startButton.icon(this.startIcon);this.endButton.icon(this.endIcon);
this.timeBar=NEO.DOM("NEO timeBar");this.timeBar.name="timeBar";this.pattern=NEO.DOM("NEO","defs","width:100%; height:20px; bottom:0;",{});c=NEO.DOM(null,"pattern","",{id:"timeBar",width:50,height:20,patternUnits:"userSpaceOnUse"},this.pattern,0);c=NEO.DOM(null,"g","",{stroke:"#888","stroke-width":"1",fill:"none"},c,0);NEO.DOM(null,"path","",{d:"M0 0"},c,0);NEO.DOM(null,"rect","",{width:"100%",height:20,x:0,fill:"url(#timeBar)"},this.pattern);this.patternLine=c.childNodes[0];this.timeBar.appendChild(this.pattern);
this.timescale=NEO.DOM("NEO timescale");this.timescale.appendChild(this.liner(1));this.timescale.appendChild(this.liner(20));this.timescale.name="timescale";this.pattern2=NEO.DOM("NEO","defs","width:100%; height:10px; top:5px;",{});c=NEO.DOM(null,"pattern","",{id:"timeScale",width:10,height:10,patternUnits:"userSpaceOnUse"},this.pattern2,0);c=NEO.DOM(null,"g","",{stroke:"#888","stroke-width":"1",fill:"none"},c,0);NEO.DOM(null,"path","",{d:"M0 10 L10 0 M0 5 L5 0 M5 10 L10 5"},c,0);NEO.DOM(null,"rect",
"",{width:"100%",height:10,x:0,fill:"url(#timeScale)"},this.pattern2);this.timescale.appendChild(this.pattern2);this.scaler=NEO.DOM("NEO","rect","width:40px; height:16px; top:2px",{width:40,height:16,x:0,y:0,fill:"rgba(0,0,0,0.5)",stroke:"#888","stroke-width":1,"stroke-linecap":"butt"});this.timescale.appendChild(this.scaler);this.miniFramePos=this.vliner(1,"#F00");this.timescale.appendChild(this.miniFramePos);this.inner=NEO.DOM("NEO inner");this.marker=NEO.DOM("NEO","rect","width:41px; height:60px;",
{width:10,height:16,x:0.5,y:21.5,fill:"rgba(255,0,0,0.3)",stroke:"#F00","stroke-width":1,"stroke-linecap":"butt"});NEO.DOM(null,"line","",{x1:5.5,y1:37,x2:5.5,y2:"100%",stroke:"#F00","stroke-width":1,"stroke-linecap":"butt"},this.marker);this.content.appendChild(this.timeBar);this.content.appendChild(this.timescale);this.content.appendChild(this.inner);this.content.appendChild(this.marker);this.content.appendChild(this.topmenu);this.colorSelect=new UIL.Color({target:this.topcontent,callback:null,
name:" ",color:"no",size:100,pos:{left:"10px",top:"20px",display:"none"},simple:!0,side:"up",type:"hex"});this.f[0]=function(a){if(a.target.name){var b=a.target.name;"timeBar"==b?this.timerdown=!0:"timescale"==b&&(this.scrolldown=!0);this.f[1](a)}}.bind(this);this.f[1]=function(a){var b=a.clientX;if(a.clientY<this.topLimite)this.f[2]();this.timerdown&&this.goTo(this.getFrameClick(b));this.scrolldown&&(this.posX=b,this.move())}.bind(this);this.f[2]=function(a){this.scrolldown=this.timerdown=!1}.bind(this);
this.content.onmousedown=this.f[0];this.content.onmousemove=this.f[1];this.content.onmouseup=this.f[2];this.content.oncontextmenu=function(a){a.preventDefault()};this.title.text2(this.frame);window.addEventListener("resize",function(a){this.resize(a)}.bind(this),!1);this.resize();this.scaletime(0.8);NEO.main=this};
NEO.Timeline.prototype={constructor:NEO.Timeline,stop:function(){this.inPlay=!1;this.playButton.icon(this.playIcon)},play:function(){this.inPlay?this.stop():(this.inPlay=!0,this.playButton.icon(this.pauseIcon),this.frame===this.maxFrame&&(this.frame=0,this.move(this.mid)),loop())},update:function(){this.now=Date.now();this.delta=this.now-this.then;if(this.delta>this.timerStep){this.frame++;this.autoScroll();this.updateTime();for(var a=this.neo.length,b;a--;)b=this.neo[a],b.update(this.frame),this.data[b.name]=
b.value;this.then=this.now-this.delta%this.timerStep;this.frame===this.maxFrame&&this.stop()}},goTo:function(a,b){this.frame=a;this.updateTime();for(var c=this.neo.length,d;c--;)d=this.neo[c],d.update(this.frame),this.data[d.name]=d.value;rootUpdate&&rootUpdate();b&&this.move(a/this.maxFrame*this.width)},show:function(){this.content.style.display="block"},hide:function(){this.content.style.display="none"},autoScroll:function(){this.frame>this.currentLeftFrame+this.viewFrame&&this.move(this.currentScrollPosition+
this.miniScaleView+this.mid)},move:function(a){a=a||this.posX;this.mid=0.5*this.miniScaleView;this.currentScrollPosition=Math.floor(Math.min(this.width-this.miniScaleView,Math.max(0,a-this.mid)));this.currentLeftFrame=Math.floor(this.currentScrollPosition*this.ratio);this.currentPosition=Math.floor(this.currentLeftFrame*this.frameSize);0>this.currentPosition&&(this.currentLeftFrame=this.currentPosition=0);this.scaler.style.left=this.currentScrollPosition+"px";this.timeBar.style.left=-this.currentPosition+
"px";this.moveMarker();for(a=this.neo.length;a--;)this.neo[a].move()},moveMarker:function(){this.marker.style.left=(this.frame-this.currentLeftFrame)*this.frameSize+"px";this.miniFramePos.style.left=this.width/this.maxFrame*this.frame+"px"},getFrameClick:function(a){a=Math.floor(a/this.frameSize)+this.currentLeftFrame;a>this.maxFrame&&(a=this.maxFrame);return a},scaletime:function(a){this.frameSize=Math.floor(10*a);this.maxSize=(this.maxFrame+1)*this.frameSize;a=[Math.round(this.frameSize)+0.5,Math.round(2*
this.frameSize)+0.5,Math.round(3*this.frameSize)+0.5,Math.round(4*this.frameSize)+0.5,Math.round(5*this.frameSize)+0.5];NEO.setSVG(this.patternLine,"d","M0.5 10 L0.5 18M"+a[0]+" 15 L"+a[0]+" 18M"+a[1]+" 15 L"+a[1]+" 18M"+a[2]+" 15 L"+a[2]+" 18M"+a[3]+" 15 L"+a[3]+" 18M-0.5 20 L"+a[4]+" 20",0);NEO.setSVG(this.pattern.childNodes[0],"width",5*this.frameSize,0);this.timeBar.style.width=this.maxSize+"px";for(a=this.neo.length;a--;)this.neo[a].setSize();a=0.5*this.frameSize+0.5;NEO.setSVG(this.marker,"width",
this.frameSize);NEO.setSVG(this.marker,"x1",a,1);NEO.setSVG(this.marker,"x2",a,1);this.setScaler();this.move()},setScaler:function(){this.ratio=this.maxFrame/this.width;this.viewFrame=Math.floor(this.width/this.frameSize);this.miniScaleView=Math.floor(this.width/this.maxFrame*this.viewFrame);this.maxSize<this.width?this.scaler.style.display="none":(this.scaler.style.display="block",this.scaler.style.width=this.miniScaleView+"px",NEO.setSVG(this.scaler,"width",this.miniScaleView))},setFps:function(a){this.fps=
a;this.timerStep=1E3/this.fps;this.updateTime()},add:function(a,b){b=b||{};var c;switch(a){case "bang":c=new NEO.Bang(b);break;case "flag":c=new NEO.Flag(b);break;case "switch":c=new NEO.Switch(b);break;case "color":c=new NEO.Color(b);break;case "curve":c=new NEO.Curve(b);break;case "lfo":c=new NEO.Lfo(b);break;case "audio":c=new NEO.Audio(b);break;case "video":c=new NEO.Video(b)}c.id=this.neo.length;c.rename();this.neo.push(c);this.calc();this.data={};return c},remove:function(a){this.neo.splice(a,
1);for(a=0;a<this.neo.length;a++)this.neo[a].id=a;this.calc();this.data={}},resize:function(a){this.viewWidth=window.innerWidth;this.viewHeight=window.innerHeight;this.width=this.viewWidth-this.decal;this.maxHeight=this.viewHeight-this.maxTop;this.content.style.height=this.height+"px";this.content.style.width=this.width+"px";this.topcontent.style.height=this.height+"px";this.timescale.style.width=this.width+"px";this.setScaler();this.move();this.topLimite=this.viewHeight-(this.height-10)},updateTime:function(){this.time=
this.frame/this.fps;var a=Math.floor(this.time/60),b=this.time%60,c=10>b?"0":"";this.title.text2(this.frame);this.title.text(a+":"+c+b.toFixed(2));this.moveMarker()},calc:function(){for(var a=0,b=this.neo.length;b--;)a+=this.neo[b].h;this.height=60+(a-1);this.content.style.height=this.height+"px";this.topcontent.style.height=this.height+"px";this.marker.style.height=this.height-20+"px";this.topLimite=this.viewHeight-(this.height-10)},liner:function(a,b){return NEO.DOM("NEO","line","width:100%; height:1px; top:"+
(a-1)+"px;",{x1:0,y1:0,x2:"100%",y2:0,stroke:b||"#888","stroke-width":1,"stroke-linecap":"butt"})},linerBottom:function(a){return NEO.DOM("NEO","line","width:100%; height:1px; bottom:0",{x1:0,y1:0,x2:"100%",y2:0,stroke:a||"#888","stroke-width":1,"stroke-linecap":"butt"})},vliner:function(a,b){return NEO.DOM("NEO","line","width:1px; height:100%; top:"+(a-1)+"px;",{x1:0,y1:0,x2:0,y2:"100%",stroke:b||"#888","stroke-width":1,"stroke-linecap":"butt"})},pins:function(){return NEO.DOM("NEO","path","width:16px; height:20px; left:0px; top:1px; pointer-events:auto; cursor:pointer;",
{width:16,height:16,d:"M 12 6 L 8 10 4 6","stroke-width":2,stroke:"#e2e2e2",fill:"none","stroke-linecap":"butt"})},dels:function(){return NEO.DOM("NEO","path","width:16px; height:20px; right:0px; top:1px; pointer-events:auto; cursor:pointer;",{width:16,height:16,d:"M 12 12 L 8 8 4 12 M 4 4 L 8 8 12 4","stroke-width":2,stroke:"#e2e2e2",fill:"none","stroke-linecap":"butt"})},showColorSelect:function(a,b,c){this.colorSelect.setCallBack(function(a){c.setColor(a)});this.colorSelect.setColor(NEO.hexToHtml(c.color));
var d=this.inner.getBoundingClientRect();this.colorSelect.hide();this.colorSelect.c[0].style.display="block";this.colorSelect.c[0].style.left=a-20+"px";this.colorSelect.c[0].style.top=b-d.top+40+"px"}};NEO.classDefine();NEO.TimerGraph=function(a){};NEO.TimerGraph.prototype={constructor:NEO.TimerGraph,init:function(){},pattern:function(){return"<svg xmlns='http://www.w3.org/2000/svg'><defs><pattern id='pp' x='0' y='0' width='50' height='20' patternUnits='userSpaceOnUse'>\n<g fill='none' stroke='#f0934e' stroke-width='1'><path d='M0 5 L0 20'/><path d='M10 10 L10 20'/><path d='M20 10 L20 20'/><path d='M30 10 L30 20'/><path d='M40 10 L40 20'/><path d='M50 5 L50 20'/></g>\n</pattern></defs><rect x='0' y='0' width='100%' height='20' fill='url(#pp)'/></svg>"}};NEO.Proto=function(a){a=a||{};this.autoName=!0;a.name&&(this.autoName=!1);this.name=a.name||this.type;this.value=null;this.h=80;this.show=!0;this.mbutton=0;this.dragEnd=this.drag=!1;this.current=null;this.currentType="none";this.currentIndex=-1;this.id=0;this.items=[];this.keys=a.keys||[];a.color&&(NEO.COLOR=a.color);this.color=NEO.COLOR;this.target=a.target||null;this.c=[];this.f=[];this.c[0]=NEO.DOM("NEO base");this.c[1]=NEO.DOM("NEO text","div","left:10px");this.c[2]=NEO.main.liner(20);this.c[3]=
NEO.main.pins();this.c[4]=NEO.main.dels();this.c[5]=NEO.DOM("NEO track");this.c[6]=NEO.DOM("NEO trackTop");this.c[7]=NEO.main.linerBottom();this.f[0]=function(){this.show?this.close():this.open()}.bind(this);this.f[1]=function(){this.clear(!0)}.bind(this);this.c[3].onclick=this.f[0];this.c[4].onclick=this.f[1]};
NEO.Proto.prototype={constructor:NEO.Proto,init:function(){this.c[0].style.background=NEO.bgcolor(this.color);for(var a=0;a<this.c.length;a++)0==a?null!==this.target?this.target.appendChild(this.c[0]):NEO.main.inner.appendChild(this.c[0]):this.c[0].appendChild(this.c[a]);this.c[5].onmouseup=function(a){this.onUp(a)}.bind(this);this.c[5].onmousedown=function(a){this.onDown(a)}.bind(this);this.c[5].onmousemove=function(a){this.onMove(a)}.bind(this);this.c[1].textContent=this.name;this.c[5].name=this.type;
this.setSize();this.keys.length&&this.addKeys()},rename:function(){this.autoName&&(this.name=this.id+"-"+this.type,this.c[1].textContent=this.name)},update:function(a){},open:function(){this.show=!0;this.setSvg(3,"d","M 12 6 L 8 10 4 6");this.h=80;this.c[2].style.display="block";this.applyHeight()},close:function(){this.show=!1;this.setSvg(3,"d","M 6 4 L 10 8 6 12");this.h=20;this.c[2].style.display="none";this.applyHeight()},applyHeight:function(){this.c[0].style.height=this.h+"px";NEO.main&&NEO.main.calc()},
move:function(){this.c[5].style.left=-NEO.main.currentPosition+"px"},setSvg:function(a,b,c,d){this.c[a].childNodes[d||0].setAttributeNS(null,b,c)},setDom:function(a,b,c){this.c[a].style[b]=c+"px"},clear:function(a){for(var b=NEO.events,c=this.c.length,d;c--;){if(0==c)null!==this.target?this.target.removeChild(this.c[0]):NEO.main.inner.removeChild(this.c[0]);else{for(d=b.length;d--;)null!==this.c[c][b[d]]&&(this.c[c][b[d]]=null);this.c[c].children&&this.clearDOM(this.c[c]);this.c[0].removeChild(this.c[c])}this.c[c]=
null}this.c=null;if(this.f){for(c=this.f.length;c--;)this.f[c]=null;this.f=null}this.value&&(this.value=null);a&&NEO.main&&NEO.main.remove(this.id)},clearDOM:function(a){for(;a.children.length;){if(a.lastChild.children)for(;a.lastChild.children.length;)a.lastChild.removeChild(a.lastChild.lastChild);a.removeChild(a.lastChild)}},setSize:function(){this.c[5].style.width=NEO.main.maxSize+"px";for(var a=NEO.main.frameSize,b=this.items.length,c;b--;)c=this.items[b],c.reSize(a)},addKeys:function(){for(var a=
this.keys.length,b;a--;)b=this.keys[a],this.add(b);this.sort()},add:function(a){var b;switch(this.type){case "bang":b=new NEO.KeyBang(a);break;case "switch":b=new NEO.KeySwitch(a,this.ends[this.keys.indexOf(a)]);break;case "flag":b=new NEO.KeyFlag(a,this.names[this.keys.indexOf(a)]);break;case "color":b=new NEO.KeyColor(a,this.colors[this.keys.indexOf(a)]||this.findColor(a),this)}this.c[5].appendChild(b.content);this.items.push(b)},remove:function(a){a=this.keys.indexOf(a);this.c[5].removeChild(this.items[a].content);
this.items[a].clear();this.items.splice(a,1);this.sort()},sort:function(){var a,b=0;this.items.sort(function(a,b){return a.id-b.id});if(this.names)for(a=0;a<this.items.length;a++)this.names[a]=this.items[a].name,this.items[a].setPy(b),2>b?b++:b=0;if(this.ends)for(a=0;a<this.items.length;a++)this.ends[a]=this.items[a].end;if(this.colors)for(a=0;a<this.items.length;a++)this.colors[a]=this.items[a].color;this.keys=[];for(a=this.items.length;a--;)this.keys.unshift(1*this.items[a].id)},onDown:function(a){var b=
a.target.name||"none";this.currentType=b;if("input"!=b&&"colorselect"!=b){var c=NEO.main.getFrameClick(a.clientX);this.mbutton=a.which;if("switch"==b||"itemSwitch"==b)for(a=this.items.length;a--;)b=this.items[a],c>=b.id&&c<=b.end&&(c==b.id&&(this.drag=!0,this.current=b,this.dragEnd=!1),c==b.end&&(this.drag=!0,this.current=b,this.dragEnd=!0));else-1<this.keys.indexOf(c)?(1==this.mbutton&&(this.drag=!0,this.currentIndex=this.keys.indexOf(c),this.current=this.items[this.keys.indexOf(c)]),3==this.mbutton&&
(this.remove(c),"color"==this.currentType&&this.upDegrad())):1==this.mbutton&&(this.add(c),this.sort(),"color"==this.currentType&&this.upDegrad())}},onOver:function(a){},onUp:function(a){this.drag&&(this.c[5].style.cursor="pointer",this.dragEnd=this.drag=!1,this.sort(),"color"==this.currentType&&this.upDegrad());this.currentType="none"},onMove:function(a){"none"!=this.currentType&&(a=NEO.main.getFrameClick(a.clientX),this.drag&&(this.c[5].style.cursor="e-resize",this.current.move(a,this.dragEnd),
"color"==this.currentType&&this.moveDegrad(this.currentIndex,a)))}};NEO.Bang=function(a){this.type="bang";NEO.Proto.call(this,a);this.init()};NEO.Bang.prototype=Object.create(NEO.Proto.prototype);NEO.Bang.prototype.constructor=NEO.Bang;NEO.Bang.prototype.update=function(a){-1<this.keys.indexOf(a)?(this.value=!0,this.c[6].style.background="rgba(86,175,178,0.3)"):(this.value=!1,this.c[6].style.background="none")};
NEO.KeyBang=function(a){this.id=a;var b=NEO.main.frameSize;this.w=b;this.content=NEO.DOM("NEO","div","width:"+this.w+"px; height:60px; left:"+a*b+"px; top:0; pointer-events:auto; cursor:e-resize;");this.content.appendChild(NEO.DOM("NEO","rect","width:100%; height:60px; top:0; ",{width:"100%",height:60,fill:"#56afb2"}));this.content.name="bang"};
NEO.KeyBang.prototype={constructor:NEO.KeyBang,clear:function(){NEO.clearDOM(this.content);this.content=null},reSize:function(a){this.w=a;this.content.style.width=this.w+"px";this.content.style.left=this.id*this.w+"px"},move:function(a){this.id=a;this.content.style.left=this.id*this.w+"px"}};NEO.hexToHtml=function(a){return"#"+("000000"+a.toString(16)).substr(-6)};NEO.numToHex=function(a){return"0x"+("000000"+a.toString(16)).substr(-6)};NEO.hexFormat=function(a){return a.toUpperCase().replace("#","0x")};NEO.lerpColor=function(a,b,c){a=[(a>>16&255)/255,(a>>8&255)/255,(a&255)/255];b=[(b>>16&255)/255,(b>>8&255)/255,(b&255)/255];a[0]+=(b[0]-a[0])*c;a[1]+=(b[1]-a[1])*c;a[2]+=(b[2]-a[2])*c;return 255*a[0]<<16^255*a[1]<<8^255*a[2]<<0};
NEO.Color=function(a){this.type="color";this.colors=a.colors||[];NEO.DID++;this.degradId="degrad"+NEO.DID;this.degrad=[];this.linear=[];this.degNumber=5;NEO.Proto.call(this,a);this.createDegrad();this.init()};NEO.Color.prototype=Object.create(NEO.Proto.prototype);NEO.Color.prototype.constructor=NEO.Color;NEO.Color.prototype.update=function(a){this.value=this.findColor(a)};
NEO.Color.prototype.findColor=function(a){var b;if(-1<this.keys.indexOf(a))b=this.colors[this.keys.indexOf(a)];else{for(var c,d,e,f,h=this.keys.length,k;h--;)k=this.keys[h],a>k&&!c&&(c=this.colors[h],e=k),a<k&&(d=this.colors[h],f=k);c||(b=d);d||(b=c);c&&d&&(b=NEO.lerpColor(c,d,(a-e)/(f-e)))}return NEO.numToHex(b||255)};
NEO.Color.prototype.createDegrad=function(){var a,b,c;for(a=this.degNumber;a--;)b=NEO.DOM("NEO","defs","position:absolute; left:100px; width:100px; height:60px;",{}),c=NEO.DOM(null,"linearGradient","",{id:this.degradId+a,x1:"0%",y1:"0%",x2:"100%",y2:"0%"},b,0),NEO.DOM(null,"rect","",{width:"100%",height:"60",stroke:"none",x:0,fill:"url(#"+(this.degradId+a)+")"},b),this.c[5].appendChild(b),this.degrad[a]=b,this.linear[a]=c;this.upDegrad()};
NEO.Color.prototype.upDegrad=function(){for(var a=NEO.main.maxFrame,b=a/this.degNumber,c=100/this.degNumber,d=this.linear.length;d--;)NEO.clearDOM(this.linear[d].childNodes[0]);for(d=this.linear.length;d--;)NEO.DOM(null,"stop","",{offset:0,"stop-color":NEO.hexToHtml(this.findColor(b*d)),"stop-opacity":1},this.linear[d],0);for(var e=this.keys.length,f,h,d=0;d<e;d++)f=(100*this.keys[d]/a).toFixed(4),h=Math.floor(f/c),NEO.DOM(null,"stop","",{offset:f/c-h,"stop-color":NEO.hexToHtml(this.colors[d]),"stop-opacity":1},
this.linear[h],0);for(d=this.linear.length;d--;)NEO.DOM(null,"stop","",{offset:1,"stop-color":NEO.hexToHtml(this.findColor(b*(d+1)-1)),"stop-opacity":1},this.linear[d],0)};NEO.Color.prototype.moveDegrad=function(a,b){this.keys[a]=b;this.upDegrad()};
NEO.Color.prototype.setSize=function(){this.c[5].style.width=NEO.main.maxSize+"px";for(var a=NEO.main.frameSize,b=this.items.length,c;b--;)c=this.items[b],c.reSize(a);a=NEO.main.maxFrame/this.degNumber*NEO.main.frameSize;for(b=this.degrad.length;b--;)this.degrad[b].style.width=a+"px",this.degrad[b].style.left=a*b+"px"};
NEO.KeyColor=function(a,b,c){this.parent=c;this.id=a;c=NEO.main.frameSize;this.color=b||255;this.w=c;this.content=NEO.DOM("NEO","div","width:10px; height:60px; left:"+a*c+"px; top:0; pointer-events:auto; cursor:e-resize;");this.content.appendChild(NEO.DOM("NEO","path","left:-6px; width:24px; height:60px; top:0; ",{d:"M 0 0 L 12 12 24 0 M 12 60 L 12 12",stroke:"rgba(0,0,0,0.3)",fill:"none","stroke-width":5,"stroke-linecap":"butt"}));this.content.appendChild(NEO.DOM("NEO","path","left:-6px; width:24px; height:60px; top:0; ",
{d:"M 0 0 L 12 12 24 0 0 0 Z",stroke:"none",fill:NEO.hexToHtml(this.color)}));this.content.appendChild(NEO.DOM("NEO","path","left:-6px; width:24px; height:60px; top:0; ",{d:"M 0 0 L 12 12 24 0 M 12 60 L 12 12",stroke:"#56afb2",fill:"none","stroke-width":1,"stroke-linecap":"butt"}));this.colorSelect=NEO.DOM("NEO","div","left:-6px; width:24px; height:24px; top:0; pointer-events:auto; cursor:pointer;");this.colorSelect.name="colorselect";this.content.appendChild(this.colorSelect);this.colorSelect.onclick=
function(a){var b=this.parent.c[0].getBoundingClientRect();NEO.main.showColorSelect(a.clientX,b.top,this)}.bind(this);this.content.name="color"};
NEO.KeyColor.prototype={constructor:NEO.KeyColor,clear:function(){NEO.clearDOM(this.content);this.content=null},reSize:function(a){this.w=a;this.content.style.left=this.id*this.w+"px"},move:function(a){this.id=a;this.content.style.left=this.id*this.w+"px"},setColor:function(a){this.color=NEO.numToHex(a);NEO.setSVG(this.content.childNodes[1],"fill",NEO.hexToHtml(this.color),0);this.parent.sort();this.parent.upDegrad()}};NEO.Curve=function(a){a=a||{};this.type="curve";NEO.Proto.call(this,a);this.value=a.value||!1;this.init()};NEO.Curve.prototype=Object.create(NEO.Proto.prototype);NEO.Curve.prototype.constructor=NEO.Curve;NEO.Curve.prototype.rSize=function(){};NEO.Flag=function(a){this.type="flag";this.names=a.names||[];this.value="";NEO.Proto.call(this,a);this.init()};NEO.Flag.prototype=Object.create(NEO.Proto.prototype);NEO.Flag.prototype.constructor=NEO.Flag;
NEO.Flag.prototype.update=function(a){for(var b=this.keys.length,c;b--;){c=this.keys[b];if(a==c){this.value=this.items[b].name;this.c[6].style.background="rgba(86,175,178,0.3)";return}if(a>c){this.value=this.items[b].name;this.c[6].style.background="none";return}}this.c[6].style.background="none";this.value=""};
NEO.KeyFlag=function(a,b){this.id=a;this.name=b||"new";var c=NEO.main.frameSize;this.w=c;this.content=NEO.DOM("NEO","div","width:"+this.w+"px; height:60px; left:"+a*c+"px; top:0; pointer-events:auto; cursor:e-resize;");this.content.appendChild(NEO.DOM("NEO","rect","width:100%; height:60px; top:0; ",{width:"100%",height:60,fill:"#56afb2"}));this.flagName=new UIL.String({target:this.content,callback:function(a){this.name=a}.bind(this),value:this.name,color:"no",size:80,simple:!0,allway:!0,pos:{left:this.w+
"px",top:"0px"}});this.content.name="bang"};NEO.KeyFlag.prototype={constructor:NEO.KeyFlag,clear:function(){this.flagName.clear();NEO.clearDOM(this.content);this.content=null},reSize:function(a){this.w=a;this.content.style.width=this.w+"px";this.content.style.left=this.id*a+"px";this.flagName.c[0].style.left=a+"px"},setPy:function(a){this.flagName.c[0].style.top=20*a+"px"},move:function(a){this.id=a;this.content.style.left=this.id*this.w+"px"}};NEO.Lfo=function(a){a=a||{};this.type="lfo";NEO.Proto.call(this,a);this.value=a.value||!1;this.init()};NEO.Lfo.prototype=Object.create(NEO.Proto.prototype);NEO.Lfo.prototype.constructor=NEO.Lfo;NEO.Lfo.prototype.rSize=function(){};NEO.Switch=function(a){this.type="switch";this.ends=a.ends||[];NEO.Proto.call(this,a);this.init()};NEO.Switch.prototype=Object.create(NEO.Proto.prototype);NEO.Switch.prototype.constructor=NEO.Switch;NEO.Switch.prototype.update=function(a){this.value=!1;this.c[6].style.background="none";for(var b=this.keys.length;b--;)if(a>=this.keys[b]&&a<=this.ends[b]){this.value=!0;this.c[6].style.background="rgba(86,175,178,0.3)";break}};
NEO.KeySwitch=function(a,b){this.id=a;this.end=b||a+3;this.length=this.end-this.id;var c=NEO.main.frameSize;this.w=c;this.content=NEO.DOM("NEO","div","width:"+this.w*(this.length+1)+"px; height:60px; left:"+a*c+"px; top:0; pointer-events:auto; cursor:default;");this.content.appendChild(NEO.DOM("NEO","rect","width:100%; height:60px; top:0; ",{width:"100%",height:60,fill:"rgba(86,175,178,0.5)"}));this.content.appendChild(NEO.DOM("NEO","div","width:"+this.w+"px; height:60px; top:0; left:0; pointer-events:auto; cursor:e-resize; background:#56afb2;"));
this.content.appendChild(NEO.DOM("NEO","div","width:"+this.w+"px; height:60px; top:0; right:0; pointer-events:auto; cursor:e-resize; background:#56afb2;"));this.content.name="switch";this.content.childNodes[1].name="switch";this.content.childNodes[2].name="switch"};
NEO.KeySwitch.prototype={constructor:NEO.KeyBang,clear:function(){NEO.clearDOM(this.content);this.content=null},reSize:function(a){this.w=a;this.content.style.width=this.w*(this.length+1)+"px";this.content.style.left=this.id*this.w+"px";this.content.childNodes[1].style.width=this.w+"px";this.content.childNodes[2].style.width=this.w+"px"},move:function(a,b){b?this.end=a:this.id=a;this.length=this.end-this.id;this.content.style.left=this.id*this.w+"px";this.content.style.width=this.w*(this.length+1)+
"px"}};NEO.Audio=function(a){a=a||{};this.type="audio";NEO.Proto.call(this,a);this.value=a.value||!1;this.init()};NEO.Audio.prototype=Object.create(NEO.Proto.prototype);NEO.Audio.prototype.constructor=NEO.Audio;NEO.Audio.prototype.rSize=function(){};NEO.Video=function(a){a=a||{};this.type="video";NEO.Proto.call(this,a);this.value=a.value||!1;this.init()};NEO.Video.prototype=Object.create(NEO.Proto.prototype);NEO.Video.prototype.constructor=NEO.Video;NEO.Video.prototype.rSize=function(){};
